With KDHC25Pers As (
Select id_number
     , mail_list_code
     , mail_list
     , mail_list_status_code
     , start_dt
     , mail_list_ctrl_code
     , segment_group
     , kdhc_xcomment
From kdhc_fy25
--Where segment_group = 'Personalized '
)
,

a as (select
co.ucinn_ascendv2__donor_id__c,
co.firstname,
co.lastname,
c.ap_contact_report_author_name_formula__c,
c.ucinn_ascendv2__contact_method__c,
c.ucinn_ascendv2__date__c,
c.ucinn_ascendv2__description__c,
c.ucinn_ascendv2__contact_report_body__c
from stg_alumni.ucinn_ascendv2__contact_report__c c
left join stg_alumni.contact co on co.id = c.ucinn_ascendv2__contact__c
where c.ap_contact_report_author_name_formula__c = 'Francesca Cornelli'
and (c.ucinn_ascendv2__contact_method__c = 'Visit'
and c.ucinn_ascendv2__date__c >= to_date ('09/01/2024', 'mm/dd/yyyy'))
--or c.ucinn_ascendv2__contact_report_name_auto_number__c IN ('CR-1100531','CR-1687627','CR-1044927')
order by c.ucinn_ascendv2__date__c ASC),

--- Listagg this

DFCCR as (select a.ucinn_ascendv2__donor_id__c,
Listagg (a.ap_contact_report_author_name_formula__c, ';  ') Within Group (Order By a.ucinn_ascendv2__date__c) As Visit_CR_author,
Listagg (a.ucinn_ascendv2__contact_method__c, ';  ') Within Group (Order By a.ucinn_ascendv2__date__c) As Visit_CR__type,
Listagg (a.ucinn_ascendv2__date__c, ';  ') Within Group (Order By a.ucinn_ascendv2__date__c) As Visit_CR__date,
Listagg (a.ucinn_ascendv2__description__c, ';  ') Within Group (Order By a.ucinn_ascendv2__date__c) As Visit_CR__desc
from a
group by a.ucinn_ascendv2__donor_id__c)
,

n as (select
a.NU_DONOR_ID__C  ,
a.CONFERENCE360__EVENT_ID__C  ,
a.CONFERENCE360__ATTENDEE_FULL_NAME__C  ,
a.CONFERENCE360__EVENT_END_DATE__C  ,
a.CONFERENCE360__EVENT_NAME__C  ,
a.CONFERENCE360__EVENT_ORGANIZER_NAME__C  ,
a.conference360__attendance_status__c
from stg_alumni.conference360__attendee__c a
where (a.CONFERENCE360__EVENT_NAME__C like '%San Francisco Kellogg Campaign Event%' -- *
or a.CONFERENCE360__EVENT_NAME__C like '%Kellogg Campaign Event hosted by Pradip Patiath%' -- *
or a.CONFERENCE360__EVENT_NAME__C like '%Dallas Kellogg Campaign Event%' -- *
or a.CONFERENCE360__EVENT_NAME__C like '%Greenwich Kellogg Campaign Event%' -- *
or a.CONFERENCE360__EVENT_NAME__C like '%London Kellogg Campaign Event%' -- *
or a.CONFERENCE360__EVENT_NAME__C like '%Palm Beach Kellogg Campaign Event%' -- *
or a.CONFERENCE360__EVENT_NAME__C like '%Sarasota Kellogg Campaign Event%' -- *
or a.CONFERENCE360__EVENT_NAME__C like '%Jackson Hole Kellogg Campaign Event%' -- *
or a.CONFERENCE360__EVENT_NAME__C like '%Naples Kellogg Campaign Event%' -- *
or a.CONFERENCE360__EVENT_NAME__C like '%Tokyo Kellogg Campaign Event%' -- *
or a.CONFERENCE360__EVENT_NAME__C like '%Chicago/Winnetka Kellogg Campaign Event%' -- %
or a.CONFERENCE360__EVENT_NAME__C like '%Seattle Kellogg Campaign Event%' -- *
or a.CONFERENCE360__EVENT_NAME__C like '%Pewaukee Kellogg Campaign Event%' -- not on original list
or a.CONFERENCE360__EVENT_NAME__C like '%Cocktail Reception hosted by Keech and Akshay Shetty - Kellogg Campaign Event%') -- *
and a.conference360__attendance_status__c like '%Attended%'
order by a.CONFERENCE360__EVENT_END_DATE__C ASC),

--- Listagg this

Ev as (select n.NU_DONOR_ID__C,
Listagg (n.CONFERENCE360__EVENT_ID__C, ';  ') Within Group (Order By n.CONFERENCE360__EVENT_END_DATE__C) As event_id,
Listagg (n.CONFERENCE360__EVENT_END_DATE__C, ';  ') Within Group (Order By n.CONFERENCE360__EVENT_END_DATE__C) As event_date,
Listagg (n.conference360__attendance_status__c, ';  ') Within Group (Order By n.CONFERENCE360__EVENT_END_DATE__C) As event_status,
Listagg (n.CONFERENCE360__EVENT_NAME__C, ';  ') Within Group (Order By n.CONFERENCE360__EVENT_END_DATE__C) As event_name,
Listagg (n.CONFERENCE360__EVENT_ORGANIZER_NAME__C, ';  ') Within Group (Order By n.CONFERENCE360__EVENT_END_DATE__C) As organizer
from n
group by n.NU_DONOR_ID__C)
,

KSM_Cornerstone As (
Select ent.donor_id
     , summ.household_id
     , ent.person_or_org
     , summ.household_account_name
     , summ.ngc_lifetime
     , summ.expendable_cfy As Expendable_FY26
     , Case When summ.expendable_cfy >= '100000' Then 'Donor_FY26'
            End As Corner_Donor_FY26
     , Case When summ.expendable_pfy1 >= '100000' Then 'Member_FY26'
            End As Corner_Member_FY26
     , summ.expendable_pfy1 As Expendable_FY25
     , Case When summ.expendable_pfy1 >= '100000' Then 'Donor_FY25'
            End As Corner_Donor_FY25
     , Case When summ.expendable_pfy2 >= '100000' Then 'Member_FY25'
            End As Corner_Member_FY25
     , summ.expendable_pfy2 As Expendable_FY24
     , Case When summ.expendable_pfy2 >= '100000' Then 'Donor_FY24'
            End As Corner_Donor_FY24
From mv_ksm_giving_summary summ
Inner Join mv_entity ent
      On ent.household_id_ksm = summ.household_id
Where (summ.expendable_cfy >= '100000'
Or summ.expendable_pfy1 >= '100000')
--Or summ.expendable_pfy2 >= '100000')
And ent.person_or_org = 'P'
)
,

New_GAB As (
Select constituent_donor_id
     , constituent_name
     , involvement_name As GAB
     , Case When involvement_start_date >= to_date ('09/01/2024', 'mm/dd/yyyy') Then 'New GAB Member'
             End as New_GAB
     , involvement_status As GAB_Status
     , involvement_type As GAB_Inv_Type
     , involvement_role As GAB_Role
     , involvement_start_date As GAB_Start_Date
     , involvement_comment As GAB_Comment
From mv_involvement
Where involvement_name = 'KSM Global Advisory Board'
And involvement_status = 'Current'
And involvement_start_date >= to_date ('09/01/2024', 'mm/dd/yyyy')
)
,

M_Full_Circle As (
Select mve.donor_id
     , giv.household_id
     , giv.full_circle_credit
     , giv.full_circle_recognition
     , Case When giv.full_circle_recognition >= '1000000'
       Then '$1M+' When giv.full_circle_recognition >= '100000'
         Then '$100,000 - $999,999' When giv.full_circle_recognition > '1'
         Then 'Under $100k' Else '' End as Mil_KFC_Donor_Rec_Level
     , Case When giv.full_circle_recognition >= '1'
            Then 'Full Circle Donor' End As Full_Circle_Donor
     , giv.last_ngc_date
     , giv.last_ngc_designation
     , giv.last_ngc_recognition_credit
From mv_ksm_giving_summary giv
Inner Join mv_entity mve
      On mve.household_id_ksm = giv.household_id
Where giv.full_circle_recognition >= '1000000'
)
,

New_BOT As (
Select mvi.constituent_donor_id
     , mvi.constituent_name
     , ksm.degrees_concat
     , ksm.program
     , ksm.first_ksm_year
     , mvi.involvement_name As BOT
     , Case When mvi.involvement_start_date >= to_date ('09/01/2024', 'mm/dd/yyyy') Then 'New BOT Member'
             End as New_BOT
     , mvi.involvement_status As BOT_Status
     , mvi.involvement_type As BOT_Inv_Type
     , mvi.involvement_role As BOT_Role
     , mvi.involvement_start_date As BOT_Start_Date
     , mvi.involvement_comment As BOT_Comment
From mv_involvement mvi
Inner Join mv_entity_ksm_degrees ksm
      On ksm.donor_id = mvi.constituent_donor_id
Where mvi.involvement_name = 'Board of Trustees'
And mvi.involvement_status = 'Current'
And mvi.involvement_start_date >= to_date ('09/01/2024', 'mm/dd/yyyy')
)
,

adds as (select e.donor_id
     , CASE When e.donor_id is not null Then '1:1 Manual Add' End as Manual_Adds
from mv_entity e
where e.donor_id IN ('0000298956', '0000342852', '0000022895', '0000545491', '0000428927')
)
,

--merge_ids As (
--Select id_number
--From KDHC25Pers
--Union
--Select ucinn_ascendv2__donor_id__c
--From DFCCR
--Union
--Select NU_DONOR_ID__C
--From Ev
--Union
--Select donor_id
--From KSM_Cornerstone
--Union
--Select constituent_donor_id
--From New_GAB
--Union
--Select donor_id
--From M_Full_Circle
--Union
--Select constituent_donor_id
--From New_BOT
--Union
--Select donor_id
--From Adds
--)
--,

--KSM_Corner_FY25 As (
--Select Distinct ME.DONOR_ID
--  , ME.SALESFORCE_ID
--    , ME.FULL_NAME
--    , SMC.AP_GIFT_CLUB_STATUS__C As Cornerstone_Status_FY25
--    , SMC.UCINN_ASCENDV2__MEMBERSHIP_LEVEL__C
--    , mem.Name As Cornerstone_Lvl_FY25
--    , SMC.ap_giving_society_name_text__c As Cornerstone_FY25
--    , SMC.UCINN_ASCENDV2__ANNIVERSARY_DATE__C
--    , SMC.UCINN_ASCENDV2__EXPIRATION_DATE__C As Cornerstone_Exp_Date_FY25
--    , SMC.UCINN_ASCENDV2__MEMBER_SINCE__C
--    , SMC.ucinn_ascendv2__comments__c
--    , smc.lastmodifieddate
--    , smc.lastmodifiedbyid
--From MV_ENTITY ME
--Inner Join stg_alumni.ucinn_ascendv2__society_membership__c SMC
--On ME.SALESFORCE_ID = SMC.UCINN_ASCENDV2__CONTACT__C
--Inner Join stg_alumni.ucinn_ascendv2__membership_level__c mem
--      On SMC.UCINN_ASCENDV2__MEMBERSHIP_LEVEL__C = mem.ID
--Where ap_gift_club_status__c = 'Active'
--  And ap_giving_society_name_text__c = 'KSM Cornerstone Donors'
--  And mem.Name = 'Member'
--  And smc.UCINN_ASCENDV2__EXPIRATION_DATE__C >= to_char(to_date('08/31/2024', 'mm/dd/yyyy'))
--  And smc.UCINN_ASCENDV2__EXPIRATION_DATE__C <= to_char(to_date('08/31/2025', 'mm/dd/yyyy'))
--)
--,

prop As (
Select donor_id
     , listagg(proposal_active_indicator, ', ') Within Group (Order By proposal_submitted_date ASC) As Prop_Active_Ind
--     , proposal_stage
--     , proposal_type
     , listagg(proposal_name, ', ') Within Group (Order By proposal_submitted_date ASC) As Prop_Name
--     , proposal_probability
--     , proposal_amount
--     , proposal_submitted_amount
--     , proposal_anticipated_amount
--     , proposal_created_date
     , listagg(proposal_submitted_date, ', ') Within Group (Order By proposal_submitted_date ASC) As Prop_Submitted_Date
--     , proposal_designation_units
     , listagg(ksm_flag, ', ') Within Group (Order By proposal_submitted_date ASC) As Prop_KSM_Flag
--     , active_proposal_manager_name
--     , active_proposal_manager_unit
From mv_proposals
Where proposal_active_indicator = 'Y'
Group By donor_id
),

Full_Circle As (
Select household_id
     , full_circle_credit
     , full_circle_recognition
     , Case When full_circle_recognition >= '1000000'
       Then '$1M+' When full_circle_recognition >= '100000'
         Then '$100,000 - $999,999' When full_circle_recognition > '1'
         Then 'Under $100k' Else '' End as KFC_Donor_Recognition_Level
     , Case When full_circle_recognition >= '1'
            Then 'Full Circle Donor' End As Full_Circle_Donor
     , last_ngc_date
     , last_ngc_designation
     , last_ngc_recognition_credit
     , last_ngc_opportunity_type
From mv_ksm_giving_summary
Where full_circle_recognition >= '1'
)
,

assign as (Select a.donor_id,
       a.prospect_manager_name,
       a.lagm_name
From mv_assignments a)
,

KSM_kids As (
Select rel.primary_donor_id
     , listagg(rel.primary_full_name, ';  ') Within Group (Order By rel.relationship_donor_id) As Primary_Full_Name
--     , listagg(pers.original_list_type, ';  ') Within Group (Order By rel.relationship_donor_id) As Original_List_Type
     , listagg(rel.relationship_status, ';  ') Within Group (Order By rel.relationship_donor_id) As Rel_Status
     , listagg(rel.primary_institutional_suffix, ';  ') Within Group (Order By rel.relationship_donor_id) As Primary_Instituational_Suffix
     , listagg(rel.primary_role, ';  ') Within Group (Order By rel.relationship_donor_id) As Primary_Role
     , listagg(rel.relationship_donor_id, ';  ') Within Group (Order By rel.relationship_donor_id) As Rel_Donor_ID
     , listagg(rel.relationship_full_name, ';  ') Within Group (Order By rel.relationship_donor_id) As Rel_Full_Name_Child
     , listagg(rel.relationship_institutional_suffix, ';  ') Within Group (Order By rel.relationship_donor_id) As Rel_Inst_Suffix_Child
     , listagg(rel.relationship_role, ';  ') Within Group (Order By rel.relationship_donor_id) As Rel_Role
From mv_entity_relationships rel
Where rel.primary_role = 'Parent'
And rel.relationship_institutional_suffix Not Like ' '
And rel.relationship_institutional_suffix Not Like 'Parent'
And rel.relationship_institutional_suffix Not Like 'Unknown'
And rel.relationship_institutional_suffix Not Like 'Parent, Trustee'
--And rel.relationship_institutional_suffix Not Like 'cKellogg%'
And rel.relationship_institutional_suffix Not Like 'CYD'
--And rel.relationship_institutional_suffix Not Like 'cProfessional%'
And rel.relationship_institutional_suffix Not Like 'Grandparent'
--And rel.primary_donor_id In ('0000583831', '0000330108', '0000442396', '0000469548', '0000462015', '0000580116', '0000376176', '0000303019', '0000347408', '0000286132', '0000645414')
Group By rel.primary_donor_id
)
,

KSM_gkids As (
Select rel.primary_donor_id
     , listagg(rel.primary_full_name, ';  ') Within Group (Order By rel.relationship_donor_id) As Primary_Full_Name
--     , listagg(pers.original_list_type, ';  ') Within Group (Order By rel.relationship_donor_id) As Original_List_Type
     , listagg(rel.relationship_status, ';  ') Within Group (Order By rel.relationship_donor_id) As Rel_Status
     , listagg(rel.primary_institutional_suffix, ';  ') Within Group (Order By rel.relationship_donor_id) As Primary_Instituational_Suffix
     , listagg(rel.primary_role, ';  ') Within Group (Order By rel.relationship_donor_id) As Primary_Role
     , listagg(rel.relationship_donor_id, ';  ') Within Group (Order By rel.relationship_donor_id) As Rel_Donor_ID
     , listagg(rel.relationship_full_name, ';  ') Within Group (Order By rel.relationship_donor_id) As Rel_Full_Name_Grandchild
     , listagg(rel.relationship_institutional_suffix, ';  ') Within Group (Order By rel.relationship_donor_id) As Rel_Inst_Suffix_Grandchild
     , listagg(rel.relationship_role, ';  ') Within Group (Order By rel.relationship_donor_id) As Rel_Role
From mv_entity_relationships rel
Where rel.primary_role = 'Grandparent'
And rel.relationship_institutional_suffix Not Like ' '
And rel.relationship_institutional_suffix Not Like 'Parent'
And rel.relationship_institutional_suffix Not Like 'Unknown'
And rel.relationship_institutional_suffix Not Like 'Parent, Trustee'
--And rel.relationship_institutional_suffix Not Like 'cKellogg%'
And rel.relationship_institutional_suffix Not Like 'CYD'
--And rel.relationship_institutional_suffix Not Like 'cProfessional%'
And rel.relationship_institutional_suffix Not Like 'Grandparent'
--And rel.primary_donor_id In ('0000583831', '0000330108', '0000442396', '0000469548', '0000462015', '0000580116', '0000376176', '0000303019', '0000347408', '0000286132', '0000645414')
Group By rel.primary_donor_id
)
,

prim_emp As (
Select distinct
       c.UCINN_ASCENDV2__RELATED_CONTACT_DONOR_ID_FORMULA__C As Donor_ID
     , max (c.ap_is_primary_employment__c) keep (dense_rank First Order by c.ucinn_ascendv2__start_date__c desc) as primary_employ_ind
     , max (c.ucinn_ascendv2__status__c) keep (dense_rank First Order by c.ucinn_ascendv2__start_date__c desc) as primary_employ_status
     , max (c.UCINN_ASCENDV2__RELATED_ACCOUNT_NAME_FORMULA__C) keep (dense_rank first order by c.ucinn_ascendv2__start_date__c desc) as primary_employer
     , max (c.ucinn_ascendv2__job_title__c) keep (dense_rank first order by c.ucinn_ascendv2__start_date__c desc) as primary_job_title
From stg_alumni.ucinn_ascendv2__Affiliation__c c
Where c.ap_is_primary_employment__c = 'true'
And c.ucinn_ascendv2__status__c = 'Current'
Group by c.UCINN_ASCENDV2__RELATED_CONTACT_DONOR_ID_FORMULA__C
)
,

sp_prim_emp As (
Select distinct
       c.UCINN_ASCENDV2__RELATED_CONTACT_DONOR_ID_FORMULA__C As Donor_ID_spouse
     , max (c.ap_is_primary_employment__c) keep (dense_rank First Order by c.ucinn_ascendv2__start_date__c desc) as primary_employ_ind_spouse
     , max (c.ucinn_ascendv2__status__c) keep (dense_rank First Order by c.ucinn_ascendv2__start_date__c desc) as primary_employ_status_spouse
     , max (c.UCINN_ASCENDV2__RELATED_ACCOUNT_NAME_FORMULA__C) keep (dense_rank first order by c.ucinn_ascendv2__start_date__c desc) as primary_employer_spouse
     , max (c.ucinn_ascendv2__job_title__c) keep (dense_rank first order by c.ucinn_ascendv2__start_date__c desc) as primary_job_title_spouse
From stg_alumni.ucinn_ascendv2__Affiliation__c c
Where c.ap_is_primary_employment__c = 'true'
And c.ucinn_ascendv2__status__c = 'Current'
Group by c.UCINN_ASCENDV2__RELATED_CONTACT_DONOR_ID_FORMULA__C
)
,

kd24 As (
Select id_number
     , listagg(segment_group,'; ') Within Group (Order By start_dt Asc) As segment_group
     , listagg(kdhc_xcomment,'; ') Within Group (Order By start_dt Asc) As kdhc_xcomment
From kdhc_FY24
Group By id_number
)

Select Distinct mve.household_id_ksm
     , mve.last_name
     , mve.household_primary_ksm
     , hhsal.joint_dean_salut
     , hhsal.joint_fullname
     , '' As Suggested_Note
     , '' As Actual_Note
     , mve.full_name
     , dsal.dean_salut
     , prof.donor_id
     , prof.original_list_type As Professional_List_Type
     , Case When rem.donor_id Not Like ' '
            Then 'On Removal List' End As Removal_Ind
     , mve.is_deceased_indicator -- Record_Status
     , mve.person_or_org
     , deg.degrees_concat
----     , deg.first_ksm_year
----     , deg.program
     , mve.institutional_suffix
     , mve.gender_code
     , mve.spouse_donor_id
     , mve.spouse_name
     , Case When sprof.donor_id Not Like ' '
            Then 'Spouse in Professional List' End As Spouse_Professional_Ind
     , Case When srem.donor_id Not Like ' '
            Then 'Spouse on Removal List' End As Spouse_Removal_Ind
     , sdsal.dean_salut As Spouse_Deans_Sal
     , smve.is_deceased_indicator As Spouse_Decd_Ind
     , sdeg.degrees_concat As Spouse_degrees_concat
----     , sdeg.first_ksm_year As Spouse_first_ksm_year
----     , sdeg.program As Spouse_Program
     , mve.spouse_institutional_suffix
     , smve.gender_code As Spouse_Gender_Code
----     , ksmk.Primary_Role_Child
----     , ksmk.Primary_Role_Type_Child
----     , ksmk.Rel_ID_Child
     , '' As REL_FULL_NAME_CHILD
     , ksmk.Rel_Full_Name_Child
     , '' As REL_INST_SUFFIX_CHILD
     , ksmk.Rel_Inst_Suffix_Child
----     , ksmk.Rel_Role_Child
----     , ksmk.Rel_Deg_Concat_Child
----     , ksmk.Rel_First_KSM_Yr_Child
----     , ksmk.Rel_Program_Child
--     , gkids.Primary_Role_Granchild
--     , gkids.Primary_Role_Type_Granchild
--     , gkids.Rel_ID_Granchild
     , '' As REL_FULL_NAME_GRANDCHILD
     , gkids.Rel_Full_Name_Grandchild
     , '' As REL_INST_SUFFIX_GRANCHILD
     , gkids.Rel_Inst_Suffix_Grandchild
--     , gkids.Rel_Role_Granchild
--     , gkids.Rel_Deg_Concat_Granchild
--     , gkids.Rel_First_KSM_Yr_Granchild
--     , gkids.Rel_Program_Granchild
     , pe.primary_employ_ind
     , pe.primary_employ_status
     , pe.primary_employer
     , pe.primary_job_title
     , spe.primary_employer_spouse
     , spe.primary_job_title_spouse
     , assign.prospect_manager_name
     , assign.lagm_name
     , mvc.address_preferred_type
     , mvc.preferred_address_line_1
     , mvc.preferred_address_city
     , mvc.preferred_address_state
     , mvc.preferred_address_postal_code
     , mvc.preferred_address_country
     , Case When mvc.preferred_address_country Like 'United States%' Then 'Domestic'
            When mvc.preferred_address_country Is Null Then '' Else 'International'
              End as Int_or_Dom
     , mvc.home_address_line_1
     , mvc.home_address_city
     , mvc.home_address_state
     , mvc.home_address_postal_code
     , mvc.home_address_country
     , shc.service_indicators_concat
     , sshc.service_indicators_concat As Sps_service_indicators_concat
     , New_GAB.New_GAB
     , New_GAB.GAB_Status As New_GAB_Status
     , shc.GAB
----     , New_GAB.GAB_Inv_Type
----     , New_GAB.GAB_Role
----     , New_GAB.GAB_Start_Date
----     , New_GAB.GAB_Comment
     , New_BOT.New_BOT
     , New_BOT.BOT_Status As New_BOT_Status
     , shc.Trustee As BOT
----     , New_BOT.BOT_Inv_Type
----     , New_BOT.BOT_Role
----     , New_BOT.BOT_Start_Date
----     , New_BOT.BOT_Comment
     , m.Mil_KFC_Donor_Rec_Level
     , cor.Expendable_FY26
     , cor.Corner_Donor_FY26
     , cor.Corner_Member_FY26
     , cor.Expendable_FY25
     , cor.Corner_Donor_FY25
     , cor.Corner_Member_FY25
----     , cor.Expendable_FY24
----     , cor.Corner_Donor_FY24
     , DFCCR.Visit_CR_author
     , DFCCR.Visit_CR__type
     , DFCCR.Visit_CR__date
     , DFCCR.Visit_CR__desc
     , Ev.event_id
     , Ev.event_status
     , Ev.event_date
     , Ev.event_name
     , Ev.organizer
     , kd.Segment_Group As KDHC25_Segment
     , kd.Kdhc_Xcomment As KDHC25_xcomment
     , Kdhc_Notes_Fy25.segment_description As KDHC_FY25_Note_Segment
     , Kdhc_Notes_Fy25.brief_note As KDHC_FY25_Note -- Check from Prof segment notes
     , Kdhc_Notes_Fy25.note_text As KDHC_FY25_Note_Text
     , Full_Circle.full_circle_credit
     , Full_Circle.full_circle_recognition
     , Full_Circle.KFC_Donor_Recognition_Level
     , Full_Circle.last_ngc_date
     , Full_Circle.last_ngc_designation
     , Full_Circle.last_ngc_recognition_credit
     , Full_Circle.last_ngc_opportunity_type
     , prop.Prop_Active_Ind
     , prop.Prop_KSM_Flag
     , prop.Prop_Name
     , prop.Prop_Submitted_Date
--     End requested headers
--     , skdhc25.Segment_Group As Spouse_Segment_Grp
--     , skdhc25.Kdhc_Xcomment As Spouse_KDHC_Comment
--     , skdhc25note.segment_description As spouse_KDHC_FY25_Note_Segment
--     , skdhc25note.brief_note As spouse_KDHC_FY25_Note
--     , skdhc25note.note_text As spouse_KDHC_FY25_Note_Text
--     , kd24.segment_group As FY24_Segment
--     , kd24.kdhc_xcomment As FY24_XComment
--     , kdn24.segment_description As FY24_Seg_Desc
--     , kdn24.brief_note As FY24_Brief_Note
--     , kdn24.text As FY24_Note_Text
--     , kd23.segment_group As FY23_Segment
--     , kd23.kdhc_xcomment As FY23_XComment
--     , kdn23.segment_description As FY23_Seg_Desc
--     , kdn23.brief_note As FY23_Brief_Note
--     , kdn23.text As FY23_Note_Text
--     , adds.Manual_Adds
--     , shc.EBFA
--     , shc.no_contact
--     , shc.no_email_ind
--     , shc.no_mail_ind
--     , sshc.gab As Sps_GAB
--     , sshc.Trustee As Sps_BOT
--     , sshc.EBFA As Sps_EFBA
--     , sshc.no_contact As Sps_No_Concat
--     , sshc.no_email_ind As Sps_No_Email_Ind
--     , sshc.no_mail_ind As Sps_No_Mail_Ind
From KDHC_Prof_FY26 prof
Inner Join mv_entity mve
     On prof.donor_id = mve.donor_id
Left Join KDHC25Pers kd
     On kd.id_number = mve.donor_id
Left Join DFCCR
     On DFCCR.ucinn_ascendv2__donor_id__c = mve.donor_id
Left Join Ev
     On Ev.NU_DONOR_ID__C = mve.donor_id
Left Join KSM_Cornerstone cor
     On cor.donor_id = mve.donor_id
Left Join New_GAB
     On New_GAB.constituent_donor_id = mve.donor_id
Left Join M_Full_Circle m
     On m.household_id = mve.household_id_ksm
Left Join New_BOT
     On New_BOT.constituent_donor_id = mve.donor_id
Left Join adds
     On adds.donor_id = mve.donor_id
Left Join mv_entity_ksm_degrees deg
     On deg.donor_id = mve.donor_id
Left Join mv_entity_ksm_degrees sdeg
     On sdeg.donor_id = mve.spouse_donor_id
Left Join prim_emp pe
     On pe.donor_id = mve.donor_id     
Left Join assign
     On assign.donor_id = mve.donor_id
Left Join Full_Circle
     On Full_Circle.household_id = mve.household_id_ksm
Left Join prop
     On prop.donor_id = mve.donor_id
Left Join Kdhc_Notes_Fy25
     On Kdhc_Notes_Fy25.Id_Number = mve.donor_id
--Left Join kdhc_fy25 skdhc25
--     On skdhc25.id_number = mve.spouse_donor_id
--Left Join Kdhc_Notes_Fy25 skdhc25note
--     On skdhc25note.Id_Number = mve.spouse_donor_id
--Left Join kd24
--     On kd24.id_number = mve.donor_id
--Left Join kdhc_FY23 kd23
--     On kd23.id_number = mve.donor_id
--Left Join kdhc_notes_FY24 kdn24
--     On kdn24.id_number = mve.donor_id
--Left Join kdhc_notes_FY23 kdn23
--     On kdn23.id_number = mve.donor_id
Left Join KSM_Kids ksmk
     On ksmk.primary_donor_id = mve.donor_id
Left Join KSM_gkids gkids -- some bad data, but pulling correctly
     On gkids.primary_donor_id = mve.donor_id
Left Join mv_entity_contact_info mvc
     On mvc.donor_id = mve.donor_id
Left Join mv_special_handling shc
     On shc.donor_id = mve.donor_id
Left Join mv_special_handling sshc
     On sshc.donor_id = mve.spouse_donor_id
Left Join V_ENTITY_SALUTATIONS_HOUSEHOLD hhsal
     On hhsal.household_id_ksm = mve.household_id_ksm
Left Join V_ENTITY_SALUTATIONS_INDIVIDUAL dsal
     On dsal.donor_id = mve.donor_id
Left Join V_ENTITY_SALUTATIONS_INDIVIDUAL sdsal
     On sdsal.donor_id = mve.spouse_donor_id
Left Join mv_entity smve
     On smve.donor_id = mve.spouse_donor_id
Left Join KDHC_Prof_FY26 sprof
     On sprof.donor_id = mve.spouse_donor_id
Left Join KDHC_Prof_Rem_FY26 srem
     On srem.donor_id = mve.spouse_donor_id
Left Join KDHC_Prof_Rem_FY26 rem
     On rem.donor_id = prof.donor_id
Left Join sp_prim_emp spe
     On spe.Donor_ID_spouse = mve.spouse_donor_id
Where mve.person_or_org = 'P'
--And prof.original_list_type = 'Professional List Handwritten'
--And prof.original_list_type = 'Professional List Email'
-- IDs updated 11/19/2025
-- mv_entity HH KSM ID is the HH ID to use
-- Highlight Fac/Staff in Inst Suffix
 -- Manually remove Spouses info when on Spouse Removal list
 -- Update Realtionships to include all NU alums and students
    -- Pulled manually, need to remove all non-alum/stu and VLookup'd info
